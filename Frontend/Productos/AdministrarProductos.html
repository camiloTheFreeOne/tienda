<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos</title>
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
</head>

<body>
     <div class="Container mt-5">
        <a href="crear.html" class="btn btn-succes">crear nuevo Producto</a>
        <hr>
        <h2>Lista de Productos</h2>
        <table id="productos-table" class="table">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>nombre</th>
                    <th>precio</th>
                    <th colspan="">actualizar</th>
                    <th colspan="">Eliminar</th>
                </tr>
            </thead>
            <tbody id="productos-body"></tbody>
        </table>
        <a href="../index.html" class="btn btn-info">volver</a>
        <script>
            document.addEventListener('DOMContentLoaded', function(){
                function cargarProductos(){
                    fetch('http://127.0.0.1:5000/productos')
                        .then(response => response.json())
                        .then(data => {
                            const productosBody = document.getElementById('productos-body');
                            productosBody.innerHTML='';
                            data.forEach(producto =>{
                                const tr = document.createElement('tr');
                                tr.innerHTML=`
                                    <td>${producto[0]}</td>
                                    <td>${producto[1]}</td>
                                    <td>${producto[2]}</td>
                                    <td><button class="btn btn-primary" onclick="actualizarProducto(${producto[0]})">Actualizar</button></td>
                                    <td><button class="btn btn-danger" onclick="eliminarProducto(${producto[0]})">Eliminar</button></td>
                                `;
                                productosBody.appendChild(tr);
                        });
                    })
                    .catch(error => console.error('Error', error));
                }
                cargarProductos();
            });
            function eliminarProducto(id){
                fetch(`http://127.0.0.1:5000/eliminar_producto/${id}`,{
                    method:'DELETE'
                })
                .then(response=> response.json())
                .then(data=>{
                    alert(data.mensaje);
                    window.location.href ='AdministrarProductos.html';
                })
                .catch(error=> console.error('Error', error));
            }
            function actualizarProducto(id){
                window.location.href=`actualizar.html?id=${id}`;
            }
        </script>

     </div>
</body>
</html>