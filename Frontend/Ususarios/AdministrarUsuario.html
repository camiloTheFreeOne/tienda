<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Usuarios</title>
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
</head>

<body>
     <div class="Container mt-5">
        <a href="crear.html" class="btn btn-succes">crear nuevo Usuario</a>
        <hr>
        <h2>Lista Usuarios</h2>
        <table id="usuarios-table" class="table">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>nombre</th>
                    <th>Email</th>
                    <th>contrase√±a</th>
                    <th colspan="">opcion actualizada</th>
                    <th colspan="">opcion Eliminar</th>
                </tr>
            </thead>
            <tbody id="usuarios-body"></tbody>
        </table>
        <a href="../index.html" class="btn btn-info">volver</a>
        <script>
            document.addEventListener('DOMContentLoaded', function(){
                function cargarUsuarios(){
                    fetch('http://127.0.0.1:5000/usuarios')
                        .then(response => response.json())
                        .then(data => {
                            const usuariosBody = document.getElementById('usuarios-body');
                            usuariosBody.innerHTML='';
                            data.forEach(usuario =>{
                                const tr = document.createElement('tr');
                                tr.innerHTML=`
                                    <td>${usuario[0]}</td>
                                    <td>${usuario[1]}</td>
                                    <td>${usuario[2]}</td>
                                    <td>${usuario[3]}</td>
                                    <td><button class="btn btn-primary" onclick="actualizarUsuario(${usuario[0]})">Actualizar</button></td>
                                    <td><button class="btn btn-danger" onclick="eliminarUsuario(${usuario[0]})">Eliminar</button></td>
                                `;
                                usuariosBody.appendChild(tr);
                        });
                    })
                    .catch(error => console.error('Error', error));
                }
                cargarUsuarios();
            });
            function eliminarUsuario(id){
                fetch(`http://127.0.0.1:5000/elimiar_usuario/${id}`,{
                    method:'DELETE'
                })
                .then(response=> response.json())
                .then(data=>{
                    alert(data.mensaje);
                    window.location.href ='AdministrarUsuario.html';
                })
                .catch(error=> console.error('Error', error));
            }
            function actualizarUsuario(id){
                window.location.href=`actualizar.html?id=${id}`;
            }
        </script>

     </div>
</body>
</html>